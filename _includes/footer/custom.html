<!-- start custom footer snippets -->

<a href="/sitemap/">Sitemap</a>

<!-- Support for MatJax -->
<script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>

<!-- Support for Plotly -->
<script defer src='https://cdnjs.cloudflare.com/ajax/libs/plotly.js/3.0.1/plotly.min.js'></script>

<!-- Support for Mermaid -->
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
    mermaid.initialize({startOnLoad:true, theme:'default'});
    await mermaid.run({querySelector:'code.language-mermaid'});
</script>

<!-- æ–¹å‘æ„ŸçŸ¥æ»šåŠ¨æ·¡å…¥æ•ˆæœ -->
<script>
// ä½¿ç”¨å¤šé‡ä¿é™©ç¡®ä¿DOMåŠ è½½å®Œæˆ
(function() {
  function initScrollFade() {
    console.log('ğŸš€ å¼€å§‹åˆå§‹åŒ–æ»šåŠ¨æ·¡å…¥');
    
    let lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    let scrollDirection = 'down';
    
    window.addEventListener('scroll', function() {
      const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
      scrollDirection = currentScrollTop > lastScrollTop ? 'down' : 'up';
      lastScrollTop = currentScrollTop;
    }, { passive: true });
    
    const elements = document.querySelectorAll(
      '.page__content h1, .page__content h2, .page__content h3, .page__content h4, ' +
      '.page__content > p, .page__content > ul, .page__content > ol, ' +
      '.page__content > div, .page__content section, ' +
      '.archive__item, .list__item'
    );
    
    console.log('ğŸ“¦ æ‰¾åˆ°å…ƒç´ ï¼š', elements.length);
    
    if (elements.length === 0) {
      console.log('âš ï¸ æ²¡æœ‰æ‰¾åˆ°å…ƒç´ ï¼Œå»¶è¿Ÿ500msé‡è¯•');
      setTimeout(initScrollFade, 500);
      return;
    }
    
    elements.forEach(el => {
      el.style.setProperty('opacity', '0', 'important');
      el.style.setProperty('transform', 'translateY(30px)', 'important');
      el.style.setProperty('transition', 'opacity 0.8s ease, transform 0.8s ease', 'important');
    });
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const el = entry.target;
        
        if (entry.isIntersecting) {
          el.style.setProperty('transition', 'none', 'important');
          el.style.setProperty('opacity', '0', 'important');
          
          if (scrollDirection === 'down') {
            el.style.setProperty('transform', 'translateY(30px)', 'important');
          } else {
            el.style.setProperty('transform', 'translateY(-30px)', 'important');
          }
          
          el.offsetHeight;
          
          el.style.setProperty('transition', 'opacity 0.8s ease, transform 0.8s ease', 'important');
          el.style.setProperty('opacity', '1', 'important');
          el.style.setProperty('transform', 'translateY(0)', 'important');
          
        } else {
          el.style.setProperty('opacity', '0', 'important');
          
          if (scrollDirection === 'down') {
            el.style.setProperty('transform', 'translateY(30px)', 'important');
          } else {
            el.style.setProperty('transform', 'translateY(-30px)', 'important');
          }
        }
      });
    }, {
      threshold: 0.15,
      rootMargin: '0px 0px -100px 0px'
    });
    
    elements.forEach(el => observer.observe(el));
    
    console.log('âœ… æ»šåŠ¨æ·¡å…¥æ•ˆæœåˆå§‹åŒ–å®Œæˆ');
  }
  
  // å¤šé‡ä¿é™©åŠ è½½æ–¹å¼
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initScrollFade);
  } else if (document.readyState === 'interactive') {
    setTimeout(initScrollFade, 100);
  } else {
    initScrollFade();
  }
  
  // é¢å¤–ä¿é™©ï¼šé¡µé¢å®Œå…¨åŠ è½½åä¹Ÿæ‰§è¡Œä¸€æ¬¡
  window.addEventListener('load', function() {
    setTimeout(initScrollFade, 200);
  });
})();
</script>

<!-- end custom footer snippets -->
